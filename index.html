function doGet(e) {
    var qrCode = e.parameter.qr || "No proporcionado";
  
    var spreadsheetId = "1xyjzRbX8kyv6TsrnPjOiiRRLeE8mvwMEQi4Wokl6m_s";
    var sheet = SpreadsheetApp.openById(spreadsheetId).getSheetByName("BD Planes");
    var data = sheet.getDataRange().getValues();
  
    var result = {
      descripcion: "Descripci√≥n no encontrada",
      cliente: "Cliente no encontrado",
      sector: "Sector no encontrado"
    };
  
    for (var i = 1; i < data.length; i++) {
      if (data[i][0] === qrCode) {
        result = {
          descripcion: data[i][6], // Columna G
          cliente: data[i][1],     // Columna B
          sector: data[i][4]       // Columna E
        };
        break;
      }
    }
  
    return ContentService.createTextOutput(JSON.stringify(result))
      .setMimeType(ContentService.MimeType.JSON);
  }
  